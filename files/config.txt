# pistomp-arch boot configuration for Raspberry Pi
# Single config for all Pi models (3/4/5) â€” stock linux-rpi kernel
# handles board detection automatically.

# Enable hardware interfaces
dtparam=i2c_arm=on
dtparam=i2s=on
dtparam=spi=on

# Kernel and initramfs
# ALARM's linux-rpi uses kernel8.img + initramfs-linux.img (not the
# auto_initramfs naming convention), so specify explicitly.
initramfs initramfs-linux.img followkernel
arm_64bit=1
arm_boost=1

# Audio codec (IQAudio DAC+)
dtoverlay=iqaudio-codec
dtparam=audio=off

# UART for MIDI
enable_uart=1
dtoverlay=miniuart-bt
dtoverlay=midi-uart0

# USB host mode
dtoverlay=dwc2,dr_mode=host

# Performance
gpu_mem=16
disable_overscan=1
disable_splash=1

# CM4-specific
[cm4]
otg_mode=1

# Board-specific SPI config
[pi3]
dtoverlay=spi0-2cs,cs0_pin=14,cs1_pin=7

[pi4]
dtoverlay=spi0-2cs,cs0_pin=0,cs1_pin=7

[pi5]
dtoverlay=spi0-2cs,cs0_pin=0,cs1_pin=7

[all]
